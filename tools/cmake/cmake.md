[[toc]]

# 第一章

## cmake特性
cmake是构建，测试，软件打包的工具

- 优势
  - 避免硬路径
  - 跨平台编译
  - 持续继承
  - 交叉编译
  - IDE可以直接利用cmake生成项目
  - 容易结合其他工具，如git，qt
  - 单元测试
- 特性
  - 自动搜索可能需要的程序，库，头文件的能力
  - 独立构建目录，不会污染源码
  - 创建复杂的自定义命令
  - 配置时选择组件的能力
  - 简单的文本文件CmakeList.txt
  - 静态库和动态库的轻松切换的能力
  - 每个IDE都支持cmake

## 原理

          ┌───────────┐
          │ CMakeCache│
          └───────────┘                             
               ▲
               │
               │ 2. 生成临时文件                    
               │
               │
               │                                    
               │         3.生成项目文件
          ┌────┴──┐                                 ┌────────────┐            ┌──────┐          ┌───────────┐        ┌──────────────┐                                    
          │ cmake ├──────────────────────┬─────────►│ build.ninja├───────────►│Ninja │────────► │ gcc/clang ├───────►│ 输出目标程序 │                                    
          └────┬──┘                      │          └────────────┘            └──────┘          └───────────┘        └──────────────┘                                    
               │                         │          ┌──────────┐              ┌───────┐                                                                                   
               │ 1.读取文件              └─────────►│ Makefile ├───────┬─────►│ make  │                                                                                   
               ▼                                    └──────────┘       │      └───────┘                                                                                   
       ┌───────────────┐                                               │      ┌──────────┐      ┌───────────┐       ┌─────────────────────┐                             
       │ CMakeLists.txt │                                               └─────►│ nmake.exe│─────►│ vs cl.exe ├──────►│ 输出windows目标程序 │                            
       └───────────────┘                                                      └──────────┘      └───────────┘       └─────────────────────┘


cmake读取CMakeList.txt生成CMakeCache，并根据执行cmake的命令和环境生成对应平台的make文件，

执行make时，会根据make文件和CMakeCache利用相关编译工具进行程序构建，


