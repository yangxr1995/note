# 非对称加密，数字签名，对称加密的实际应用

## 场景
由于业务需要，你和我需要签署一份合作协议。为方便起见，

你将拟好的电子版合同文本在线发送给我签署。怎样确保合同只有我可查看且不被他人恶意窃取？我又怎样才能确定文件的发送人就是你呢？

## 关键点1 非对称加密

使用非对称加密确保发送方和接受接受的身份. 和内容的保密性

非对称加密：具有唯一对应的一对秘钥，一个公钥一个私钥，公钥所有人可见，而私钥仅自己可见。

非对称加密具有这样的特性：用公钥加密的文件只能用私钥解密，而私钥加密的文件只能用公钥解密。

发送合同时，你将拟好的电子合同使用自己的私钥加密后发送；

接收合同时，如果能够使用你的公钥解密，则说明这份文件就是你发送的。

但是，我怎么才能知道你的公钥呢？

## 关键点2: CA机构

政府出了个CA来帮忙我了解到，政府授权了一个权威机构叫CA，可以提供网络身份认证的服务。

CA (Certificate Authority) ：全称证书管理机构，即数字证书的申请、签发及管理机关。

其主要功能为： 产生密钥对、生成数字证书、分发密钥、密钥管理等。

数字证书：是由CA机构颁发的证明，它包含公钥、公钥拥有者名称、CA 的数字签名、有效期、授权中心名称、证书序列号等信息，可以通俗为理解个人或企业在“网络身份证”。

我向CA机构申请获取你的公钥，使用它对电子合同解密，解密成功则说明发送人就是你。

文件发送人的身份确认了，那怎么保障电子合同传输过程中未被篡改呢？

## 关键点3: 哈希确保传输过程中数据的完整

哈希可以证明电子合同传输过程中是否被篡改。

哈希算法：通过加密算法将文本内容生成为一段代码，即信息摘要，其主要特征是加密过程不需要密钥，经加密的数据无法被反向还原。

也就是说，只有两份完全相同的合同经过相同的哈希算法才能得到相同的摘要。

发送合同时，你将电子合同原文和经哈希运算的摘要一起发送给我接收合同时，

通过对合同原文进行同样的哈希运算得到新的摘要，对比两组摘要是否一致即可证明我接收的文件是否被篡改

但是，如果传输过程中文件原文与摘要同时被替换了怎么办？

## 关键点4: 对称加密原文和摘要，避免 原文和摘要同时被替换

对称加密：采用单钥密码系统的加密方法，信息的加密和解密只能使用同一个密码。

### 发送文件

1、你通过哈希运算得到原文摘要并使用私钥对其加密，得到你的数字签名，再将数字签名和合同原文进行对称加密，得到密文A——对原文加密

2、再通过CA获得我的公钥，对上述步骤中对称加密的秘钥进行非对称加密，即我的“数字信封”——对秘钥加密

3、将密文A和我的数字信封一起发送给我

* 数字签名：用哈希算法提取出源文件的摘要并用发送人的私钥进行加密后的内容。

* 数字信封：用接收方的公钥加密对称秘钥”，这就叫“给乙的数字信封。

### 接收文件

1、我使用自己的私钥解密数字信封得到对称秘钥——能解开，说明是发给我的

2、再使用对称秘钥解密密文A，得到带有你的数字签名的原文

3、使用你的公钥解密你的数字签名，得到签名中的原文摘要——能解开，说明发送者是你

4、使用相同的摘要算法获取原文摘要并与解密签名中的摘要对比——摘要一致，则说明原文没有被篡改除了文件内容不可篡改，

精确记录签署时间固定合同生效期限也十分重要，网络环境中怎样怎么确保合同签署时间不可篡改呢？

## 关键点5：时间戳

我们国家还有专门确定时间的法定授时中心，

它可以在我们签署的文件上加盖“时间印迹”，即时间戳。

时间戳（time-stamp）：书面签署文件的时间是由签署人自己写上，而数字时间戳则由第三方认证单位（DTS）添加，

以DTS收到文件的时间为依据，更精准、更有公信力。

至此，我们签合同的时间精准记录、合同内容不可篡改、双方身份也真实有效，这下没问题了！

但是，签署完的电子合同怎么存储呢？不管是哪一方签署，日后产生纠纷都难免对合同存储期间的安全性产生质疑。

## 关键点6 第三方电子数据存储机构

找个权威第三方来存证听说有专门的第三方电子数据存证机构，可以保存已签署的电子合同数据，

当用户双方对合同内容产生争议时可申请出具具有公信力的证明。合同签署的最后一个问题：存储问题也解决了！

但唯一不足之处就是：签署过程太麻烦！为保障电子合同有效性，我们用到了非对称加密、哈希运算、时间戳等技术，还要CA机构、公证处等机构协助；

怎样更简单快捷地签一份有效的电子合同呢？

## 总结

我们可归纳总结有效的电子合同应关注以下几个核心点：

内容保密性、

内容防篡改、

明确签订身份、

明确签订时间。

同时，为保障电子合同作为书面形式的证据能力，合同签署全程还应当由权威第三方机构存储公证。
